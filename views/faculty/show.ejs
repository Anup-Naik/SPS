<%- include('../partials/header'); -%>
<%- include('../partials/navbar'); -%>

<div class="container">
  <h1>Students Under Faculty: <%= faculty.name %></h1>
  <div class="studentList">
    <% const visitedStudents = new Set(); %>
    <% faculty.mentees.sort((a, b) => a.mentee.sem - b.mentee.sem).forEach(mentee => {
      const student = mentee.mentee;
      if (
        student.fullname &&
        student.usn &&
        student.sem &&
        student.contactNum &&
        student.email &&
        student.facultyAdvisorName &&
        !visitedStudents.has(student._id)
      ) {
        visitedStudents.add(student._id);
    %>
    <div class="card mb-3">
      <div class="card-header">
        <h5 class="card-title">Student: <%= student.fullname %></h5>
      </div>
      <div class="card-body">
        <p><strong>USN:</strong> <%= student.usn %></p>
        <p><strong>Semester:</strong> <%= student.sem %></p>
        <p><strong>Contact:</strong> <%= student.contactNum %></p>
        <p><strong>Email:</strong> <%= student.email %></p>
        <a href="/mentees/<%= student._id %>/profile" class="btn btn-primary">View Profile</a>
        <a href="/mentees/<%= student._id %>/progress" class="btn btn-success">View Academic Progress</a>
        <a href="/mentees/<%= student._id %>/report" class="btn btn-info">Generate Report</a>
        <a href="/mentees/<%= student._id %>/studentFiles" class="btn btn-secondary">View Files</a>
      </div>
    </div>
    <% }}); %>
  </div>
</div>

<%- include('../partials/footer'); -%>
